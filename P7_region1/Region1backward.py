#---------------------------------------------------------------------------
# Backware Equation for Region 1:
#   IAPWS-IF97-Rev : (P,S)->T (P,H)->T
#       pstoTreg1(p,s)
#       phtoTreg1(p,h)
#   Supp-PHS12-2014: (H,S)->P
#      hstopreg1(h,s) 
#---------------------------------------------------------------------------

def thetaPHreg1(pi,  eta):
    """  Dimensionless form Backward equation T(p,h) for region 1
            Initialize coefficients and exponents
              IAPWS-IF97-Rev :Page 11, Table6 :
    """
    IJN =[
      [0, 0, -0.23872489924521E+03]
     ,[0, 1, 0.40421188637945E+03]
     ,[0, 2, 0.11349746881718E+03]
     ,[0, 6, -0.58457616048039E+01]
     ,[0, 22, -1.528548241314E-04]

     ,[0, 32, -0.10866707695377E-05]
     ,[1, 0, -0.13391744872602E+02]
     ,[1, 1,  0.43211039183559E+02]
     ,[1, 2,  -0.54010067170506E+02]
     ,[1, 3,  0.30535892203916E+02]

     ,[1, 4, -0.65964749423638E+01]
     ,[1,10,  0.93965400878363E-02]
     ,[1,32,  0.11573647505340E-06]
     ,[2,10, -0.25858641282073E-04]
     ,[2,32, -0.40644363084799E-08]
          
     ,[3,10, 0.66456186191635E-07]
     ,[3,32, 0.80670734103027E-10]
     ,[4,32,-0.93477771213947E-12]
     ,[5,32,  0.58265442020601E-14]
     ,[6,32,  -0.15020185953503E-16]
        ]  
   
    eta=eta+1.0
    theta=0
    for k in range(20):
       theta += IJN[k][2]*pow(pi,IJN[k][0])*pow(eta,IJN[k][1])
    return theta


def phtoTreg1(p,h):
    pi=p/1.0
    eta=h/2500.0
    return (1.0*thetaPHreg1(pi,eta))

def thetaPStoT(pi,sigma):
    """  Dimensionless form Backward equation T(p,s) for region 1
            Initialize coefficients and exponents
               IAPWS-IF97-Rev :Page 12, Table 8 :
    """
    IJN=[ [ 0, 0, 0.17478268058307E+03]
         ,[ 0, 1, 0.34806930892873E+02]
         ,[ 0, 2, 0.65292584978455E+01]
         ,[ 0, 3, 0.33039981775489]
         ,[ 0,11, -0.19281382923196E-06]

         ,[ 0, 31, -0.24909197244573E-22]
         ,[ 1, 0,  -0.26107636489332]
         ,[ 1, 1,   0.22592965981526]
         ,[ 1, 2,  -0.64256463395226E-01]
         ,[ 1, 3,   0.78876289270526E-02]

         ,[ 1, 12,  0.35672110607366E-9]
         ,[ 1, 31,  0.17332496994895E-23]
         ,[ 2,  0,  0.56608900654837E-03]
         ,[ 2,  1,  -0.32635483139717E-03]
         ,[ 2,  2,   0.44778286690632E-04]

         ,[ 2, 9,   -0.51322156908507E-9]
         ,[ 2, 31,  -0.42522657042207E-25]
         ,[ 3, 10,   0.26400441360689E-12]
         ,[ 3, 32,   0.78124600459723E-28]
         ,[ 4, 32,   -0.30732199903668E-30]
        ]

    sigma=sigma+2.0
    theta=0.0
    for k in range(20):
      theta += IJN[k][2]*pow(pi,IJN[k][0])*pow(sigma,IJN[k][1])
    return theta

def pstoTreg1(p,s):
    pi=p/1.0
    sigma=s/1.0
    return (1.0*thetaPStoT(pi,sigma))


def piHS(eta, sigma):
    """  Dimensionless form Backward equation P(h,s) for region 1
          Initialize coefficients and exponents 
            Supp-PHS12-2014:  Table 2 Page 5:
    """
    IJN=[
          [ 0, 0,  -0.691997014660582]
         ,[ 0, 1,  -0.183612548787560E+02]
         ,[ 0, 2,  -0.928332409297335E+01]
         ,[ 0, 4,   0.659639569909906E+02]
         ,[ 0, 5,   -0.162060388912024E+02]

         ,[ 0, 6,  0.450620017338667E+03]
         ,[ 0, 8,  0.854680678224170E+03]
         ,[ 0, 14, 0.607523214001162E+04]
         ,[ 1, 0,  0.326487682621856E+02]
         ,[ 1, 1, -0.269408844582931E+02]

         ,[ 1, 4, -0.319947848334300E+03]
         ,[ 1, 6, -0.928354307043320E+03]
         ,[ 2, 0,  0.303634537455249E+02]
         ,[ 2, 1, -0.650540422444146E+02]
         ,[ 2, 10,-0.430991316516130E+04]

         ,[ 3, 4, -0.747512324096068E+03]
         ,[ 4, 1,  0.730000345529245E+03]
         ,[ 4, 4,  0.114284032569021E+04]
         ,[ 5, 0, -0.436407041874559E+03]
        ] 

    eta=eta+0.05
    sigma=sigma+0.05
    pi=0.0
    for k in range(19):
      pi += IJN[k][2]*pow(eta,IJN[k][0])*pow(sigma,IJN[k][1])
    return pi

def hstopreg1(h,s):
    eta=h/3400.0
    sigma=s/7.6
    return (100.0*piHS(eta,sigma))

